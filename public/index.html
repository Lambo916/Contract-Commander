<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contract Commander</title>
  <meta name="description" content="Draft, customize, and export professional contracts (NDAs, MOUs, Service Agreements) with AI assistance. Secure, fast, and export-ready.">
  
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/contract-commander-logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/contract-commander-logo.png">
  <link rel="apple-touch-icon" href="/assets/contract-commander-logo.png">
  <meta name="theme-color" content="#F5C543">
  
  <meta property="og:title" content="Contract Commander">
  <meta property="og:description" content="Draft, customize, and export professional contracts (NDAs, MOUs, Service Agreements) with AI assistance.">
  <meta property="og:type" content="website">
  
  <link rel="stylesheet" href="/ybg.css">
  <link rel="stylesheet" href="/bizplan-styles.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="/pdf-export.js"></script>
  <script>
    window.currentToolkitName = "Contract Commander";
    window.currentToolkitLogo = "/assets/contract-commander-logo.png";
  </script>
</head>
<body>
  <div class="ybg-wrap">
    <div class="ybg-hero">
      <img class="ybg-logo" src="/assets/contract-commander-logo.png" alt="Contract Commander logo"/>
      <div>
        <div class="ybg-title">Contract Commander</div>
        <div class="ybg-sub">Create NDAs, MOUs, and Service Agreements with AI.</div>
      </div>
    </div>

    <!-- Theme Toggle -->
    <button id="theme-toggle" class="theme-toggle" data-testid="button-theme-toggle" aria-label="Toggle theme">
      <span class="theme-icon">ðŸŒ™</span>
      <span class="theme-label">Theme</span>
    </button>

    <div class="ybg-card">
      <div class="ybg-section-title">Input</div>
      <div class="ybg-grid">
        <!-- Contract Setup -->
        <div class="full ybg-subsection-title">Contract Setup</div>
        <div>
          <label>Contract Type *</label>
          <select id="contractType" data-testid="select-contract-type">
            <option value="NDA">NDA</option>
            <option value="Service Agreement" selected>Service Agreement</option>
            <option value="MOU">MOU</option>
            <option value="Employment Agreement">Employment Agreement</option>
            <option value="Partnership Agreement">Partnership Agreement</option>
            <option value="Custom">Custom</option>
          </select>
        </div>
        <div>
          <label>Contract Title *</label>
          <input id="title" placeholder="e.g., Consulting Services Agreement" data-testid="input-title"/>
        </div>
        <div>
          <label>Effective Date *</label>
          <input type="date" id="effectiveDate" data-testid="input-effective-date"/>
        </div>
        <div>
          <label>Tone</label>
          <select id="tone" data-testid="select-tone">
            <option value="Professional">Professional</option>
            <option value="Friendly">Friendly</option>
            <option value="Legal">Legal</option>
          </select>
        </div>
        <div>
          <label>Detail Level</label>
          <select id="detailLevel" data-testid="select-detail-level">
            <option value="Summary">Summary</option>
            <option value="Standard" selected>Standard</option>
            <option value="Comprehensive">Comprehensive</option>
          </select>
        </div>

        <!-- Parties -->
        <div class="full ybg-subsection-title">Parties</div>
        <div class="full">
          <label>Number of Parties *</label>
          <select id="numberOfParties" data-testid="select-number-of-parties">
            <option value="2" selected>2 Parties</option>
            <option value="3">3 Parties</option>
            <option value="4">4 Parties</option>
            <option value="5">5 Parties</option>
            <option value="6">6 Parties</option>
          </select>
        </div>
        <div class="full">
          <label>Your Organization Name *</label>
          <input id="partyAName" placeholder="Your Company Name" data-testid="input-party-a-name"/>
        </div>
        <div class="full">
          <label>Your Role *</label>
          <select id="partyARole" data-testid="select-party-a-role">
            <option value="Company">Company</option>
            <option value="Employer">Employer</option>
            <option value="Client">Client</option>
            <option value="Service Provider">Service Provider</option>
            <option value="Disclosing Party">Disclosing Party</option>
            <option value="Partner">Partner</option>
          </select>
        </div>
        <div class="full">
          <label>Counterparty Name *</label>
          <input id="partyBName" placeholder="Other Party Name" data-testid="input-party-b-name"/>
        </div>
        <div class="full">
          <label>Counterparty Role *</label>
          <select id="partyBRole" data-testid="select-party-b-role">
            <option value="Contractor">Contractor</option>
            <option value="Vendor">Vendor</option>
            <option value="Consultant">Consultant</option>
            <option value="Employee">Employee</option>
            <option value="Receiving Party">Receiving Party</option>
            <option value="Partner">Partner</option>
            <option value="Client">Client</option>
          </select>
        </div>

        <!-- Additional Parties (C, D, E, F) - Initially Hidden -->
        <div id="partyCContainer" class="full additional-party" style="display: none;">
          <label>Party C Name</label>
          <input id="partyCName" placeholder="Party C Name" data-testid="input-party-c-name"/>
        </div>
        <div id="partyCRoleContainer" class="full additional-party" style="display: none;">
          <label>Party C Role</label>
          <input id="partyCRole" placeholder="e.g., Partner" data-testid="input-party-c-role"/>
        </div>

        <div id="partyDContainer" class="full additional-party" style="display: none;">
          <label>Party D Name</label>
          <input id="partyDName" placeholder="Party D Name" data-testid="input-party-d-name"/>
        </div>
        <div id="partyDRoleContainer" class="full additional-party" style="display: none;">
          <label>Party D Role</label>
          <input id="partyDRole" placeholder="e.g., Investor" data-testid="input-party-d-role"/>
        </div>

        <div id="partyEContainer" class="full additional-party" style="display: none;">
          <label>Party E Name</label>
          <input id="partyEName" placeholder="Party E Name" data-testid="input-party-e-name"/>
        </div>
        <div id="partyERoleContainer" class="full additional-party" style="display: none;">
          <label>Party E Role</label>
          <input id="partyERole" placeholder="e.g., Advisor" data-testid="input-party-e-role"/>
        </div>

        <div id="partyFContainer" class="full additional-party" style="display: none;">
          <label>Party F Name</label>
          <input id="partyFName" placeholder="Party F Name" data-testid="input-party-f-name"/>
        </div>
        <div id="partyFRoleContainer" class="full additional-party" style="display: none;">
          <label>Party F Role</label>
          <input id="partyFRole" placeholder="e.g., Guarantor" data-testid="input-party-f-role"/>
        </div>

        <!-- Contract Terms -->
        <div class="full ybg-subsection-title">Contract Terms</div>
        <div class="full">
          <label>Scope of Work / Purpose</label>
          <textarea id="scope" placeholder="Describe the services, work, or purpose..." data-testid="input-scope"></textarea>
        </div>
        <div class="full">
          <label>Compensation / Payment Terms</label>
          <textarea id="compensation" placeholder="e.g., $5,000/month, hourly rate, or 'N/A'" data-testid="input-compensation"></textarea>
        </div>
        <div>
          <label>Term / Duration</label>
          <input id="term" placeholder="e.g., 6 months, until terminated" data-testid="input-term"/>
        </div>
        <div class="full">
          <label>Termination Terms</label>
          <textarea id="termination" placeholder="e.g., Either party may terminate with 30 days notice." data-testid="input-termination"></textarea>
        </div>

        <!-- Legal Options -->
        <div class="full ybg-subsection-title">Legal Options</div>
        <div>
          <label>Governing Law / Jurisdiction</label>
          <input id="governingLaw" placeholder="e.g., California, USA" value="California, USA" data-testid="input-governing-law"/>
        </div>
        <div>
          <label>IP Ownership</label>
          <select id="ipOwnership" data-testid="select-ip-ownership">
            <option value="Company owns">Company owns</option>
            <option value="Contractor owns">Contractor owns</option>
            <option value="Joint">Joint</option>
          </select>
        </div>
        <div class="full">
          <label>
            <input type="checkbox" id="confidentiality" checked data-testid="input-confidentiality"/>
            Include Confidentiality / NDA Clause
          </label>
        </div>
        <div class="full">
          <label>Additional Clauses</label>
          <textarea id="extraClauses" placeholder="Add any additional terms or special clauses..." data-testid="input-extra-clauses"></textarea>
        </div>

        <!-- Signatures -->
        <div class="full ybg-subsection-title">Signatures</div>
        <div>
          <label>Signatory 1 Name</label>
          <input id="signatory1Name" placeholder="e.g., John Smith" data-testid="input-signatory1-name"/>
        </div>
        <div>
          <label>Signatory 1 Title</label>
          <input id="signatory1Title" placeholder="e.g., CEO" data-testid="input-signatory1-title"/>
        </div>
        <div>
          <label>Signatory 2 Name</label>
          <input id="signatory2Name" placeholder="e.g., Jane Doe" data-testid="input-signatory2-name"/>
        </div>
        <div>
          <label>Signatory 2 Title</label>
          <input id="signatory2Title" placeholder="e.g., Contractor" data-testid="input-signatory2-title"/>
        </div>
        <div class="full">
          <button class="btn btn-primary btn-generate-inline" id="btn-generate" data-testid="button-generate" title="Generate contract">Generate Contract</button>
        </div>
      </div>

      <!-- Navigation Bar -->
      <div id="command-bar" class="command-bar">
        <div class="command-bar-group">
          <div class="dropdown">
            <button class="btn btn-command" id="btn-file" data-testid="button-file" title="File operations">
              File â–¾
            </button>
            <div class="dropdown-menu" id="file-menu">
              <button class="dropdown-item" id="btn-new-plan" data-testid="button-new-plan" title="Start a new contract (Ctrl+N)">New <span class="shortcut">Ctrl+N</span></button>
              <button class="dropdown-item" id="btn-open" data-testid="button-open" title="Open a saved report">Open</button>
              <button class="dropdown-item" id="btn-save" data-testid="button-save" title="Save this report (Ctrl+S)">Save <span class="shortcut">Ctrl+S</span></button>
              <button class="dropdown-item" id="btn-save-as" data-testid="button-save-as" title="Save with a new name">Save As...</button>
              <button class="dropdown-item" id="btn-rename" data-testid="button-rename" title="Rename current file">Rename...</button>
            </div>
          </div>

          <div class="dropdown">
            <button class="btn btn-command" id="btn-export" data-testid="button-export" title="Export your report">
              Export â–¾
            </button>
            <div class="dropdown-menu" id="export-menu">
              <button class="dropdown-item" id="btn-export-pdf" data-testid="button-export-pdf" title="Download as PDF">PDF</button>
              <button class="dropdown-item" id="btn-export-word" data-testid="button-export-word" title="Download as Word document">Word (.docx)</button>
            </div>
          </div>

          <div class="dropdown">
            <button class="btn btn-command" id="btn-tools" data-testid="button-tools" title="Tools and utilities">
              Tools â–¾
            </button>
            <div class="dropdown-menu" id="tools-menu">
              <button class="dropdown-item" id="btn-clear-all" data-testid="button-clear-all" title="Clear all inputs and results">Clear All</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Report View Container -->
      <div id="results-container" class="ybg-results">
        <div class="ybg-section-title">Results</div>
        
        <!-- Loading Progress (shown during generation) -->
        <div id="generation-progress" class="generation-progress" style="display:none;">
          <div class="progress-bar">
            <div class="progress-bar-fill"></div>
          </div>
          <div class="progress-text">Generating your contract...</div>
        </div>
        
        <!-- Report Metadata (shown after generation, inside Results panel) -->
        <div id="report-metadata" class="report-meta-inline" style="display:none;">
          <div class="meta-item"><strong>Contract Type:</strong> <span id="meta-contract-type">â€”</span></div>
          <div class="meta-item"><strong>Parties:</strong> <span id="meta-parties">â€”</span></div>
          <div class="meta-item"><strong>Effective Date:</strong> <span id="meta-effective-date">â€”</span></div>
          <div class="meta-item"><strong>Generated:</strong> <span id="meta-timestamp">â€”</span></div>
        </div>
        
        <div id="report-view" class="report-view"></div>
      </div>
    </div>

    <div class="ybg-footer">
      <div style="text-align: center; margin-bottom: 8px;">
        Powered by <a href="https://yourbizguru.com" target="_blank">yourbizguru.com</a> | 
        <a href="/privacy.html" target="_blank">Privacy Policy</a> | 
        <a href="/terms.html" target="_blank">Terms of Service</a>
      </div>
      <div style="text-align: center; font-size: 11px; color: var(--ybg-muted); opacity: 0.8;">
        Disclaimer: For informational purposes only. Not legal, tax, or financial advice.
      </div>
    </div>
  </div>

  <!-- Save Report Modal -->
  <div id="save-modal" class="modal" role="dialog" aria-labelledby="save-modal-title" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="save-modal-title">Save Report</h2>
        <button class="modal-close" data-testid="button-close-save-modal" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <label for="save-title">Report Title</label>
        <input type="text" id="save-title" class="modal-input" placeholder="Report title" data-testid="input-save-title"/>
        <p class="modal-hint">You can save up to 30 reports.</p>
        <div id="save-status" class="modal-status"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" id="save-cancel" data-testid="button-save-cancel">Cancel</button>
        <button class="btn btn-primary" id="save-confirm" data-testid="button-save-confirm">Save</button>
      </div>
    </div>
  </div>

  <!-- Load Report Modal -->
  <div id="load-modal" class="modal" role="dialog" aria-labelledby="load-modal-title" aria-hidden="true">
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h2 id="load-modal-title">Load Report</h2>
        <button class="modal-close" data-testid="button-close-load-modal" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <input type="text" id="load-search" class="modal-input" placeholder="Search reports..." data-testid="input-load-search"/>
        <div id="reports-list" class="report-list" data-testid="list-reports"></div>
        <div id="load-pagination" class="pagination"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" id="load-cancel" data-testid="button-load-cancel">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Clear Confirmation Modal -->
  <div id="clear-modal" class="modal" role="dialog" aria-labelledby="clear-modal-title" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="clear-modal-title">Clear Report?</h2>
        <button class="modal-close" data-testid="button-close-clear-modal" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <p>Clear the current report? This does not delete any saved copies.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" id="clear-cancel" data-testid="button-clear-cancel">Cancel</button>
        <button class="btn btn-primary" id="clear-confirm" data-testid="button-clear-confirm">Clear</button>
      </div>
    </div>
  </div>


  <!-- Save As / Rename Modal -->
  <div id="saveas-modal" class="modal" role="dialog" aria-labelledby="saveas-modal-title" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="saveas-modal-title">Save As</h2>
        <button class="modal-close" data-testid="button-close-saveas-modal" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <label for="saveas-filename">File Name</label>
        <input type="text" id="saveas-filename" class="modal-input" placeholder="Enter filename" data-testid="input-saveas-filename"/>
        <p class="modal-hint">This name will be used for exports and file management</p>
        <div id="saveas-status" class="modal-status"></div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-ghost" id="saveas-cancel" data-testid="button-saveas-cancel">Cancel</button>
        <button class="btn btn-primary" id="saveas-confirm" data-testid="button-saveas-confirm">Save</button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toast-container" class="toast-container" data-testid="toast-container"></div>

  <script src="https://cdn.jsdelivr.net/npm/html-docx-js@0.3.1/dist/html-docx.js"></script>
  <script>
    if (typeof htmlDocx !== 'undefined' && typeof htmlDocx.asBlob === 'function') {
      console.log('âœ“ Word export module (html-docx-js) loaded successfully');
    } else {
      console.error('âœ— Word export module failed to load. htmlDocx:', typeof htmlDocx);
    }
  </script>
  <script src="/bizplan-app.js"></script>
</body>
</html>
